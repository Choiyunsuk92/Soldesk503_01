<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="testSpringBoot.mapper.surveyMapper">
<sql id = "maxNum">
	select nvl(max(question_num),0) + 1 
	from question
	where user_id = #{userId}
</sql>
<!-- 질문을 입력하기 위한 쿼리 -->
<insert id = "questionInsert" parameterType="testSpringBoot.domain.QuestionDTO">
	insert into question(user_id, question_num, question_title)
	values(#{userId}, (<include refid="maxNum" /> ), #{questionTitle} )  
</insert>
<select id = "questionNum" parameterType = "string" resultType = "int">
	select max(question_num) from question
	where user_id = #{userId}
</select>
<insert id = "optionInsert" parameterType="testSpringBoot.domain.OptionsDTO">
	insert into OPTIONS (user_id,QUESTION_NUM,OPTIONS_NUM , OPTIONS_NAME)
	values(#{userId}, #{questionNum}, #{optionNum}, #{optionName} )  
</insert>
</mapper>